package types_test

import (
	"testing"

	. "github.com/centrifuge/go-substrate-rpc-client/v4/types"
)

var (
	testCollatorID        = [32]U8{1, 2, 3, 4, 5, 6, 7, 8, 9}
	testCollatorSignature = [64]U8{9, 8, 7, 6, 5, 4}

	testCandidateDescriptor = CandidateDescriptor{
		ParachainID:                  11,
		RelayParent:                  NewHash([]byte("hash")),
		CollatorID:                   testCollatorID,
		PersistentValidationDataHash: NewHash([]byte("hash2")),
		PoVHash:                      NewHash([]byte("hash3")),
		ErasureRoot:                  NewHash([]byte("hash4")),
		CollatorSignature:            testCollatorSignature,
		ParaHead:                     NewHash([]byte("hash5")),
		ValidationCodeHash:           NewHash([]byte("hash6")),
	}

	testCandidateReceipt = CandidateReceipt{
		Descriptor:      testCandidateDescriptor,
		CommitmentsHash: NewHash([]byte("hash7")),
	}
)

func TestCandidateReceipt_EncodeDecode(t *testing.T) {
	assertRoundtrip(t, testCandidateReceipt)
}

func TestCandidateReceipt_Encode(t *testing.T) {
	assertEncode(t, []encodingAssert{
		{
			testCandidateReceipt,
			MustHexDecodeString("0x0b0000006861736800000000000000000000000000000000000000000000000000000000010203040506070809000000000000000000000000000000000000000000000068617368320000000000000000000000000000000000000000000000000000006861736833000000000000000000000000000000000000000000000000000000686173683400000000000000000000000000000000000000000000000000000009080706050400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000686173683500000000000000000000000000000000000000000000000000000068617368360000000000000000000000000000000000000000000000000000006861736837000000000000000000000000000000000000000000000000000000"),
		},
	})
}

func TestCandidateReceipt_Decode(t *testing.T) {
	assertDecode(t, []decodingAssert{
		{
			MustHexDecodeString("0x0b0000006861736800000000000000000000000000000000000000000000000000000000010203040506070809000000000000000000000000000000000000000000000068617368320000000000000000000000000000000000000000000000000000006861736833000000000000000000000000000000000000000000000000000000686173683400000000000000000000000000000000000000000000000000000009080706050400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000686173683500000000000000000000000000000000000000000000000000000068617368360000000000000000000000000000000000000000000000000000006861736837000000000000000000000000000000000000000000000000000000"),
			testCandidateReceipt,
		},
	})
}
